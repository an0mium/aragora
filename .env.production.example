# Aragora Production Environment Configuration
# Copy this file to .env.production and fill in your values

# =============================================================================
# REQUIRED: Domain and SSL
# =============================================================================

# Your domain name (must point to this server)
DOMAIN=aragora.yourdomain.com

# Email for Let's Encrypt SSL certificates
ACME_EMAIL=admin@yourdomain.com

# =============================================================================
# REQUIRED: AI Provider Keys (at least one required)
# =============================================================================

# Anthropic (Claude) - Recommended primary
ANTHROPIC_API_KEY=sk-ant-...

# OpenAI (GPT-4) - Optional but recommended for diversity
OPENAI_API_KEY=sk-...

# OpenRouter - Fallback for rate limiting
OPENROUTER_API_KEY=sk-or-...

# =============================================================================
# REQUIRED: Security
# =============================================================================

# Strong random password for PostgreSQL (min 32 chars)
# Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=

# API token for server-to-server auth (generate with: openssl rand -hex 32)
ARAGORA_API_TOKEN=

# JWT signing secret (generate with: python -c "import secrets; print(secrets.token_urlsafe(48))")
ARAGORA_JWT_SECRET=

# Encryption key for secrets-at-rest (64 hex chars)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
ARAGORA_ENCRYPTION_KEY=

# Grafana admin password
GRAFANA_ADMIN_PASSWORD=

# =============================================================================
# REQUIRED: Security Hardening (Production Defaults)
# =============================================================================

# Environment mode - MUST be "production" for production deployments
ARAGORA_ENV=production

# Strict deployment validation - fails startup if critical issues found
# Default: true in production (do not disable unless you know what you're doing)
ARAGORA_STRICT_DEPLOYMENT=true

# CORS allowed origins - NEVER use "*" in production
# Comma-separated list of allowed domains
ARAGORA_ALLOWED_ORIGINS=https://aragora.yourdomain.com

# Rate limiting backend - MUST be "redis" for multi-instance deployments
ARAGORA_RATE_LIMIT_BACKEND=redis

# =============================================================================
# Redis High Availability (Sentinel)
# =============================================================================

# Redis mode: "standalone" or "sentinel"
# Sentinel mode provides automatic failover with 3-node cluster
ARAGORA_REDIS_MODE=sentinel

# Sentinel hosts (comma-separated host:port pairs)
# These are the Sentinel instances that monitor the Redis master
ARAGORA_REDIS_SENTINEL_HOSTS=sentinel-1:26379,sentinel-2:26379,sentinel-3:26379

# Sentinel master name (must match sentinel.conf)
ARAGORA_REDIS_SENTINEL_MASTER=mymaster

# Redis password (optional, for authenticated clusters)
REDIS_PASSWORD=

# Legacy: Redis URL for standalone mode (use rediss:// for TLS)
# Only used when ARAGORA_REDIS_MODE=standalone
ARAGORA_REDIS_URL=redis://redis:6379/0

# Force HTTPS for all requests
ARAGORA_FORCE_HTTPS=true

# HSTS enabled (Strict-Transport-Security header)
ARAGORA_HSTS_ENABLED=true

# Content Security Policy (customize if needed)
# ARAGORA_CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; ...

# =============================================================================
# OPTIONAL: Runtime Data Directory
# =============================================================================

# Where runtime databases and caches are stored
ARAGORA_DATA_DIR=/var/lib/aragora
# Persist canonical convoys/beads
ARAGORA_CANONICAL_STORE_PERSIST=1
# Optional: override convoy/bead store location
# ARAGORA_STORE_DIR=/var/lib/aragora/.aragora_beads

# =============================================================================
# OPTIONAL: Scaling
# =============================================================================

# Number of API server replicas (default: 2)
ARAGORA_REPLICAS=2

# Number of worker replicas (default: 2)
WORKER_REPLICAS=2

# Max concurrent debates per replica (default: 20)
ARAGORA_MAX_CONCURRENT_DEBATES=20

# =============================================================================
# OPTIONAL: Stripe Billing
# =============================================================================

STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# =============================================================================
# OPTIONAL: S3 Backup
# =============================================================================

# S3 bucket for off-site backups
BACKUP_S3_BUCKET=

# AWS credentials for backup uploads
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# Local backup retention (days)
BACKUP_RETENTION_DAYS=30

# =============================================================================
# OPTIONAL: Observability
# =============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR)
ARAGORA_LOG_LEVEL=INFO

# Traefik log level
TRAEFIK_LOG_LEVEL=INFO

# Grafana settings
GRAFANA_ADMIN_USER=admin

# =============================================================================
# OPTIONAL: Traefik Dashboard (protected by basic auth)
# Generate with: htpasswd -nb admin yourpassword
# =============================================================================

TRAEFIK_DASHBOARD_USERS=admin:$$apr1$$REPLACE_WITH_HTPASSWD_HASH
