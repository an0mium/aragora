# Kustomization for Aragora Kubernetes Deployment
# Usage: kubectl apply -k deploy/k8s/
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: aragora

resources:
  - namespace.yaml
  - cert-manager.yaml      # ClusterIssuers for TLS certificates
  - configmap.yaml
  - secret.yaml
  - secrets.yaml           # Application secrets template
  - network-policy.yaml    # Zero-trust network segmentation
  # Database (use managed service in production)
  - postgres-statefulset.yaml  # Self-hosted PostgreSQL (dev/small deployments)
  # Redis for shared state and caching
  - redis/statefulset.yaml
  - redis/service.yaml
  # - redis/cluster.yaml   # Uncomment for Redis Cluster deployment
  # Application
  - deployment.yaml
  - service.yaml
  - ingress.yaml
  - hpa.yaml
  # - hpa-custom-metrics.yaml  # Uncomment when Prometheus Adapter is installed
  - pdb.yaml

commonLabels:
  app.kubernetes.io/part-of: aragora
  app.kubernetes.io/managed-by: kustomize

images:
  - name: aragora
    newName: your-registry/aragora
    newTag: latest
