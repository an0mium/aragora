# =============================================================================
# Aragora Production Environment Template
# =============================================================================
#
# Copy this file to .env and fill in the required values:
#   cp .env.template .env
#
# The install.sh script will auto-generate secrets for you.
# You only need to supply AI provider API keys manually.
#
# =============================================================================

# -----------------------------------------------------------------------------
# AI Provider API Keys (at least one REQUIRED)
# -----------------------------------------------------------------------------

# Anthropic Claude -- recommended primary provider
# Get yours at: https://console.anthropic.com/
ANTHROPIC_API_KEY=

# OpenAI GPT -- optional secondary provider
# Get yours at: https://platform.openai.com/api-keys
OPENAI_API_KEY=

# OpenRouter -- automatic fallback on rate-limit (429) errors
# Get yours at: https://openrouter.ai/keys
OPENROUTER_API_KEY=

# Mistral -- optional for Mistral Large / Codestral agents
MISTRAL_API_KEY=

# Google Gemini -- optional
GEMINI_API_KEY=

# xAI Grok -- optional
XAI_API_KEY=

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------

# Username for the Aragora database
POSTGRES_USER=aragora

# Strong password -- auto-generated by install.sh
POSTGRES_PASSWORD=CHANGEME_POSTGRES_PASSWORD

# Database name
POSTGRES_DB=aragora

# Constructed internally by docker-compose; no need to edit
# DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# -----------------------------------------------------------------------------
# Redis
# -----------------------------------------------------------------------------

# Password for Redis authentication -- auto-generated by install.sh
REDIS_PASSWORD=CHANGEME_REDIS_PASSWORD

# Maximum memory Redis is allowed to use
REDIS_MAXMEMORY=512mb

# Redis deployment mode: standalone | sentinel | cluster
ARAGORA_REDIS_MODE=standalone

# Sentinel mode settings (required only when ARAGORA_REDIS_MODE=sentinel)
ARAGORA_REDIS_SENTINEL_HOSTS=
ARAGORA_REDIS_SENTINEL_MASTER=mymaster

# Distributed rate limiting backend (redis recommended for multi-instance)
ARAGORA_RATE_LIMIT_BACKEND=redis

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------

# JWT signing secret for authentication tokens
# Generate manually: openssl rand -base64 32
ARAGORA_JWT_SECRET=CHANGEME_JWT_SECRET

# Encryption key for secrets/token storage in production
# Generate manually: openssl rand -hex 32
ARAGORA_ENCRYPTION_KEY=CHANGEME_ENCRYPTION_KEY

# API token for programmatic / service-to-service access (optional)
# Generate manually: openssl rand -base64 48
ARAGORA_API_TOKEN=

# HMAC key for signing decision receipts
# Generate manually: openssl rand -base64 32
ARAGORA_RECEIPT_SIGNING_KEY=CHANGEME_RECEIPT_KEY

# CORS allowed origins -- NEVER use '*' in production
# Comma-separated list of allowed origins
ARAGORA_ALLOWED_ORIGINS=https://yourdomain.com

# Trusted proxy CIDR ranges (for X-Forwarded-For behind nginx)
ARAGORA_TRUSTED_PROXIES=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# Cookie security (must be true when behind HTTPS in production)
ARAGORA_COOKIE_SECURE=true
ARAGORA_COOKIE_HTTPONLY=true
ARAGORA_COOKIE_SAMESITE=Strict

# Deployment strictness (recommended true in production)
ARAGORA_STRICT_DEPLOYMENT=true

# Secrets backend strict mode (set true only when AWS Secrets Manager is configured)
ARAGORA_SECRETS_STRICT=false

# -----------------------------------------------------------------------------
# Server
# -----------------------------------------------------------------------------

# Environment mode: production | staging | development
ARAGORA_ENV=production

# Ports exposed on the host
ARAGORA_PORT=8080
ARAGORA_WS_PORT=8765

# Log level: DEBUG | INFO | WARNING | ERROR
ARAGORA_LOG_LEVEL=INFO

# Log format: json (production) | text (development)
ARAGORA_LOG_FORMAT=json

# Maximum concurrent debates
ARAGORA_MAX_CONCURRENT_DEBATES=10

# Rate limit: max requests per minute per IP
ARAGORA_RATE_LIMIT=100

# -----------------------------------------------------------------------------
# Data Persistence
# -----------------------------------------------------------------------------

# Persist canonical bead/convoy store to disk
ARAGORA_CANONICAL_STORE_PERSIST=1

# Store directory inside the container (mapped to a Docker volume)
ARAGORA_STORE_DIR=/app/data/.aragora_beads

# Data directory
ARAGORA_DATA_DIR=/app/data

# -----------------------------------------------------------------------------
# TLS / Domain (for nginx reverse proxy)
# -----------------------------------------------------------------------------

# Your public domain name
ARAGORA_DOMAIN=aragora.example.com

# Legacy alias used by some validation tooling
DOMAIN=${ARAGORA_DOMAIN}

# Email for Let's Encrypt certificate notifications
ACME_EMAIL=admin@example.com

# Set to "selfsigned" to generate a self-signed cert, or "letsencrypt"
# for automatic Let's Encrypt via certbot. Default: selfsigned
TLS_MODE=selfsigned

# -----------------------------------------------------------------------------
# Monitoring (optional -- enabled with --profile monitoring)
# -----------------------------------------------------------------------------

# Grafana admin credentials
GRAFANA_USER=admin
GRAFANA_PASSWORD=CHANGEME_GRAFANA_PASSWORD

# Prometheus data retention
PROMETHEUS_RETENTION=15d

# Expose metrics endpoint on the Aragora container
ARAGORA_METRICS_ENABLED=true

# -----------------------------------------------------------------------------
# Workers (optional -- enabled with --profile workers)
# -----------------------------------------------------------------------------

# Number of debate worker replicas
WORKER_REPLICAS=2

# Concurrency per worker (simultaneous debates per worker process)
WORKER_CONCURRENCY=3

# -----------------------------------------------------------------------------
# Backup (optional -- enabled with --profile backup)
# -----------------------------------------------------------------------------

# Number of days to retain database backups
BACKUP_RETENTION_DAYS=7

# Backup schedule in seconds (default: 86400 = daily)
BACKUP_INTERVAL=86400

# Decision receipt retention (default ~7 years for compliance)
ARAGORA_RECEIPT_RETENTION_DAYS=2555

# -----------------------------------------------------------------------------
# Integrations (all optional)
# -----------------------------------------------------------------------------

# Slack
# SLACK_BOT_TOKEN=xoxb-...
# SLACK_SIGNING_SECRET=

# Microsoft Teams
# TEAMS_APP_ID=
# TEAMS_APP_PASSWORD=

# SSO / OIDC
# ARAGORA_SSO_ENABLED=false
# ARAGORA_SSO_PROVIDER_TYPE=oidc
# ARAGORA_SSO_CLIENT_ID=
# ARAGORA_SSO_CLIENT_SECRET=
# ARAGORA_SSO_ISSUER_URL=

# OpenTelemetry
# OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317

# Sentry
# SENTRY_DSN=

# -----------------------------------------------------------------------------
# Audit
# -----------------------------------------------------------------------------

ARAGORA_AUDIT_ENABLED=true
