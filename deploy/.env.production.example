# =============================================================================
# Aragora Production Environment Configuration
# =============================================================================
# This template contains safe production defaults. Copy it and fill in secrets:
#   cp .env.production.example .env
#
# SECURITY NOTE: Use a secrets manager (AWS Secrets Manager, K8s Secrets,
# Vault) for API keys and passwords in real production deployments.
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED: AI Provider Keys (at least one)
# -----------------------------------------------------------------------------
ANTHROPIC_API_KEY=
OPENAI_API_KEY=
# Fallback provider (handles quota errors automatically)
OPENROUTER_API_KEY=

# -----------------------------------------------------------------------------
# REQUIRED: Security
# -----------------------------------------------------------------------------
ARAGORA_ENV=production

# JWT secret for authentication
# Generate: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
ARAGORA_SECRET_KEY=CHANGE_ME_GENERATE_A_REAL_SECRET

# API token for programmatic access
# Generate: python3 -c "import secrets; print(secrets.token_urlsafe(48))"
ARAGORA_API_TOKEN=

# HMAC key for signing decision receipts
# Generate: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
ARAGORA_RECEIPT_SIGNING_KEY=

# CRITICAL: Never use '*' in production. List your actual origins.
ARAGORA_ALLOWED_ORIGINS=https://yourdomain.com

# Cookie security (all must be true in production behind HTTPS)
ARAGORA_COOKIE_SECURE=true
ARAGORA_COOKIE_HTTPONLY=true
ARAGORA_COOKIE_SAMESITE=Strict

# -----------------------------------------------------------------------------
# Server
# -----------------------------------------------------------------------------
ARAGORA_HOST=0.0.0.0
ARAGORA_API_PORT=8080
ARAGORA_WS_PORT=8765
ARAGORA_LOG_LEVEL=INFO
ARAGORA_LOG_FORMAT=json

# Data directory
ARAGORA_DATA_DIR=/app/data
ARAGORA_CANONICAL_STORE_PERSIST=1
ARAGORA_STORE_DIR=/app/data/.aragora_beads

# -----------------------------------------------------------------------------
# Database (PostgreSQL required for production)
# -----------------------------------------------------------------------------
ARAGORA_DB_BACKEND=postgres
POSTGRES_USER=aragora
POSTGRES_PASSWORD=CHANGE_ME_USE_STRONG_PASSWORD
POSTGRES_DB=aragora
DATABASE_URL=postgresql://aragora:${POSTGRES_PASSWORD}@db:5432/aragora
ARAGORA_POSTGRES_DSN=postgresql://aragora:${POSTGRES_PASSWORD}@db:5432/aragora

# -----------------------------------------------------------------------------
# Redis (required for multi-instance deployments)
# -----------------------------------------------------------------------------
ARAGORA_REDIS_URL=redis://redis:6379

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
ARAGORA_RATE_LIMIT=100

# -----------------------------------------------------------------------------
# Observability
# -----------------------------------------------------------------------------
ARAGORA_METRICS_ENABLED=true
# SENTRY_DSN=
# OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317

# -----------------------------------------------------------------------------
# Audit
# -----------------------------------------------------------------------------
ARAGORA_AUDIT_ENABLED=true

# -----------------------------------------------------------------------------
# Trusted Proxies (for X-Forwarded-For behind a load balancer)
# -----------------------------------------------------------------------------
ARAGORA_TRUSTED_PROXIES=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# =============================================================================
# Setup:
# 1. cp .env.production.example .env
# 2. Replace all CHANGE_ME values with real secrets
# 3. Set at least one AI provider key
# 4. Set ARAGORA_ALLOWED_ORIGINS to your actual domain
# 5. docker compose up -d
# 6. Verify: curl http://localhost:8080/healthz
# =============================================================================
