# Aragora Penetration Test Scope Document

**Version:** 1.0
**Date:** February 3, 2026
**Status:** Ready for vendor engagement

## Executive Summary

Aragora is a multi-agent AI debate platform serving enterprise customers. This document defines the scope for external penetration testing to validate security posture before GA release.

## System Overview

| Component | Technology | Exposure |
|-----------|------------|----------|
| Backend API | Python (aiohttp) | Internet-facing |
| Frontend | React/TypeScript | Internet-facing |
| Database | PostgreSQL/SQLite | Internal only |
| Cache | Redis | Internal only |
| WebSocket | aiohttp | Internet-facing |
| OAuth Providers | Slack, Teams, Google, GitHub | External integrations |

## In-Scope Components

### 1. REST API Endpoints (Priority: HIGH)

**Base URL:** `https://api.aragora.ai/api/v1/`

| Category | Endpoints | Risk Level |
|----------|-----------|------------|
| Authentication | `/auth/*`, `/oauth/*`, `/sso/*` | CRITICAL |
| Debates | `/debates/*`, `/consensus/*`, `/decisions/*` | HIGH |
| Knowledge | `/knowledge/*`, `/facts/*`, `/evidence/*` | HIGH |
| Admin | `/admin/*`, `/users/*`, `/workspaces/*` | CRITICAL |
| Billing | `/billing/*`, `/payments/*`, `/subscriptions/*` | CRITICAL |
| Integrations | `/integrations/*`, `/webhooks/*`, `/connectors/*` | HIGH |

**Total Endpoints:** 2,189 documented via OpenAPI

### 2. WebSocket Streams (Priority: HIGH)

| Stream | Purpose |
|--------|---------|
| `/ws/debate/{id}` | Real-time debate events |
| `/ws/notifications` | User notifications |
| `/ws/admin/metrics` | Admin dashboard |

### 3. OAuth Flows (Priority: CRITICAL)

| Provider | Scopes |
|----------|--------|
| Slack | `channels:history`, `chat:write`, `commands`, `users:read` |
| Microsoft Teams | `https://graph.microsoft.com/.default`, `offline_access` |
| Google (Gmail) | `gmail.send`, `gmail.readonly` |
| GitHub | `repo`, `read:org`, `write:discussion` |

### 4. Webhook Receivers (Priority: HIGH)

| Endpoint | Source |
|----------|--------|
| `/webhooks/slack` | Slack Events API |
| `/webhooks/github` | GitHub App webhooks |
| `/webhooks/stripe` | Stripe payment events |
| `/webhooks/teams` | Microsoft Bot Framework |

## Out-of-Scope

- Third-party infrastructure (Slack, Teams, GitHub, Stripe APIs)
- CDN/DDoS protection layer (Cloudflare)
- Physical infrastructure
- Social engineering attacks
- Denial of Service testing (coordinate separately)

## Testing Objectives

### Authentication & Authorization

1. **JWT Token Security**
   - Token forgery attempts
   - Token expiration bypass
   - Refresh token abuse
   - Cross-tenant token reuse

2. **OAuth Security**
   - State parameter validation (CSRF)
   - Authorization code replay
   - Token leakage via redirects
   - Scope escalation

3. **RBAC Enforcement**
   - Permission boundary testing (50+ permissions)
   - Role hierarchy bypass
   - Cross-workspace access
   - Admin privilege escalation

### Input Validation

1. **Injection Attacks**
   - SQL injection (parameterized queries in place)
   - NoSQL injection (JSONB queries)
   - Command injection
   - Template injection

2. **Cross-Site Scripting (XSS)**
   - Stored XSS in debate content
   - Reflected XSS in API responses
   - DOM XSS in WebSocket messages

3. **Server-Side Request Forgery (SSRF)**
   - Webhook URL validation bypass
   - Internal network probing
   - Cloud metadata access (AWS/GCP/Azure)

### Business Logic

1. **Multi-Tenancy Isolation**
   - Cross-tenant data access
   - Workspace boundary enforcement
   - Resource quota bypass

2. **Rate Limiting**
   - Bypass techniques
   - Resource exhaustion
   - API key abuse

3. **Billing Security**
   - Payment manipulation
   - Subscription bypass
   - Coupon/discount abuse

### API Security

1. **REST API**
   - IDOR (Insecure Direct Object Reference)
   - Mass assignment vulnerabilities
   - Excessive data exposure
   - Broken function level authorization

2. **WebSocket**
   - Connection hijacking
   - Message injection
   - Authorization on reconnect
   - Rate limit bypass

3. **File Handling**
   - Upload validation bypass
   - Path traversal
   - Malicious file processing

## Test Environment

### Staging Environment

- **API:** `https://staging-api.aragora.ai`
- **Frontend:** `https://staging.aragora.ai`
- **Database:** Isolated staging instance
- **Test accounts:** Provided separately

### Test Data Requirements

- Multi-tenant setup with 3+ workspaces
- Users with various role assignments
- Sample debates with real AI agent responses
- Connected OAuth integrations (test apps)

## Deliverables Expected

1. **Executive Summary** - High-level findings for leadership
2. **Technical Report** - Detailed vulnerability descriptions
3. **Proof of Concept** - Reproducible exploit steps
4. **Risk Ratings** - CVSS scores for each finding
5. **Remediation Guidance** - Fix recommendations
6. **Retest Results** - Verification of fixes

## Timeline

| Phase | Duration | Activities |
|-------|----------|------------|
| Planning | 1 week | Scope review, environment setup |
| Testing | 2-3 weeks | Active penetration testing |
| Reporting | 1 week | Report writing, review |
| Remediation | 1-2 weeks | Fix identified issues |
| Retest | 3-5 days | Verify fixes |

**Total:** 5-7 weeks

## Budget Estimate

| Tier | Scope | Estimated Cost |
|------|-------|----------------|
| Basic | API + Auth only | $15,000 - $25,000 |
| Standard | Full scope excluding source code | $25,000 - $40,000 |
| Comprehensive | Full scope + source code review | $40,000 - $60,000 |

## Recommended Vendors

| Vendor | Specialty | Notes |
|--------|-----------|-------|
| NCC Group | Enterprise, AI/ML systems | Strong in API testing |
| Bishop Fox | Web applications | Excellent reporting |
| Synack | Crowdsourced + managed | Continuous testing option |
| Cobalt | PTaaS model | Good for ongoing retests |
| Trail of Bits | Code review, cryptography | If receipt signing needs audit |

## Rules of Engagement

1. Testing window: Business hours (9 AM - 6 PM UTC) unless coordinated
2. No destructive testing without explicit approval
3. Stop immediately if production data is accessed
4. All findings reported within 24 hours via secure channel
5. No testing of third-party services (Slack, Stripe, etc.)
6. Provide 48-hour notice before high-impact tests

## Points of Contact

| Role | Name | Contact |
|------|------|---------|
| Security Lead | TBD | security@aragora.ai |
| Engineering | TBD | engineering@aragora.ai |
| Legal | TBD | legal@aragora.ai |

## Existing Security Controls

### Already Implemented

- HMAC signature verification for webhooks
- SSRF protection via URL allowlisting (`validate_webhook_url()`)
- Rate limiting (IP-based and user-based)
- RBAC with 50+ granular permissions
- Input validation on all POST endpoints
- CSP headers (no unsafe-eval)
- JWT with short expiration + refresh tokens
- Audit logging for security events
- Cryptographic receipt signing (HMAC-SHA256, RSA, Ed25519)

### Recent Fixes (Verified)

- SSRF in `external_integrations.py` - Fixed at all 3 webhook endpoints
- Path traversal prevention - SAFE_ID_PATTERN validation
- Thread pool limits - Max 10 concurrent debates

## Appendix: Test Credentials

*To be provided securely via 1Password or similar*

- Admin account (all permissions)
- Regular user account
- Read-only account
- Billing admin account
- Integration service account
- OAuth test applications (Slack, Teams, GitHub)

---

**Document Owner:** Security Team
**Last Updated:** February 3, 2026
**Classification:** Internal - Vendor Shared
