# Aragora Penetration Testing Scope Document

**Version:** 1.0.0
**Classification:** Confidential
**Last Updated:** January 2026
**SOC 2 Control:** CC7.1 - Security Testing

---

## Executive Summary

This document defines the scope, methodology, and rules of engagement for penetration testing of the Aragora multi-agent vetted decisionmaking control plane. Annual penetration testing is required for SOC 2 Type II certification.

---

## Engagement Overview

### Objectives

1. Identify vulnerabilities in the Aragora platform before malicious actors
2. Validate effectiveness of existing security controls
3. Satisfy SOC 2 CC7.1 requirements for security testing
4. Provide actionable remediation guidance

### Testing Type

| Approach | Description |
|----------|-------------|
| **Gray Box** | Testers receive API documentation, authentication credentials, and architecture overview |
| **Annual Frequency** | Full assessment annually, with quarterly vulnerability scans |
| **Duration** | 2-3 weeks active testing |

---

## In-Scope Systems

### Production Environment

| Component | Endpoint | Priority |
|-----------|----------|----------|
| **API Gateway** | api.aragora.ai | Critical |
| **Live Dashboard** | live.aragora.ai | High |
| **Marketing Site** | aragora.ai | Medium |
| **Status Page** | status.aragora.ai | Low |
| **WebSocket Server** | wss://api.aragora.ai/ws | High |

### API Endpoints (400+ endpoints)

| Category | Base Path | Priority |
|----------|-----------|----------|
| Authentication | `/api/auth/*` | Critical |
| Debates | `/api/debates/*` | High |
| Admin | `/api/admin/*` | Critical |
| Users | `/api/users/*` | High |
| Billing | `/api/billing/*` | Critical |
| Knowledge Mound | `/api/knowledge/*` | Medium |
| Evidence | `/api/evidence/*` | Medium |
| Workflows | `/api/workflows/*` | Medium |
| Health | `/api/health/*` | Low |

### Infrastructure (If Applicable)

| Component | Notes |
|-----------|-------|
| PostgreSQL Database | Test via application layer only |
| Redis Cache | Test via application layer only |
| S3/Object Storage | Test file upload endpoints |
| CDN | Test cache bypass, origin access |

---

## Out of Scope

### Excluded Systems

| System | Reason |
|--------|--------|
| Third-party AI providers | Anthropic, OpenAI, etc. - covered by their own assessments |
| Payment processor | Stripe - PCI DSS certified |
| Email delivery | SendGrid/Postmark - separate vendor |
| DNS infrastructure | Cloudflare - separate vendor |
| Monitoring stack | Prometheus, Grafana - internal only |

### Excluded Techniques

| Technique | Reason |
|-----------|--------|
| Denial of Service (DoS) | Risk of production impact |
| Physical attacks | Out of scope for application test |
| Social engineering of employees | Separate engagement required |
| Supply chain attacks | Out of scope |
| Zero-day exploitation | Requires separate disclosure process |

---

## Testing Methodology

### Phase 1: Reconnaissance (Days 1-2)

- API documentation review
- Endpoint enumeration
- Authentication flow analysis
- Technology stack identification
- Public information gathering (OSINT)

### Phase 2: Authentication Testing (Days 3-5)

| Test | Description |
|------|-------------|
| JWT Analysis | Token structure, signing algorithm, expiration |
| Session Management | Cookie flags, session fixation, concurrent sessions |
| OAuth/OIDC Flows | State parameter, redirect URI validation |
| MFA Bypass | OTP brute force, recovery flow weaknesses |
| API Key Security | Key rotation, scope enforcement, revocation |
| Rate Limiting | Login attempts, API abuse |

### Phase 3: Authorization Testing (Days 6-8)

| Test | Description |
|------|-------------|
| IDOR | Object reference manipulation across all endpoints |
| RBAC Bypass | Role escalation, permission boundary violations |
| Multi-tenancy | Cross-workspace data access |
| Admin Functions | Privilege escalation to admin |
| API Versioning | Legacy endpoint access |

### Phase 4: Input Validation (Days 9-11)

| Test | Description |
|------|-------------|
| SQL Injection | All database-backed endpoints |
| NoSQL Injection | Redis, document store queries |
| XSS (Stored/Reflected) | User-generated content, error messages |
| Command Injection | File operations, system commands |
| SSRF | External URL handling, webhooks |
| XXE | XML parsing endpoints |
| Path Traversal | File upload, download, static resources |

### Phase 5: Business Logic (Days 12-14)

| Test | Description |
|------|-------------|
| Debate Manipulation | Vote tampering, consensus manipulation |
| Billing Bypass | Usage limit evasion, plan enforcement |
| Workflow Abuse | Approval bypass, state manipulation |
| Rate Limit Bypass | Distributed attacks, header manipulation |
| Data Export | Bulk extraction, scraping protection |

### Phase 6: Cryptography (Days 15-16)

| Test | Description |
|------|-------------|
| Encryption at Rest | Secrets storage validation |
| Transport Security | TLS configuration, certificate pinning |
| Key Management | Rotation procedures, key storage |
| Random Number Generation | Token predictability |

### Phase 7: Infrastructure (Days 17-18)

| Test | Description |
|------|-------------|
| Cloud Configuration | S3 bucket permissions, IAM policies |
| Container Security | Image vulnerabilities, runtime config |
| Network Segmentation | Internal service access |
| Secrets Exposure | Environment variables, config files |

---

## Rules of Engagement

### Authorization

```
Testing is authorized by: [CTO/CISO Name]
Authorization Date: [Date]
Valid Until: [Date + 1 year]
```

### Communication

| Event | Contact | Method |
|-------|---------|--------|
| Test Start | security@aragora.ai | Email |
| Critical Finding | security@aragora.ai + [Phone] | Email + Phone |
| Daily Status | security@aragora.ai | Email |
| Test Complete | security@aragora.ai | Email |

### Data Handling

- No exfiltration of real customer data
- Use only test accounts provided
- All findings data encrypted in transit and at rest
- Report delivered via secure channel
- Data destroyed 30 days after engagement

### Testing Windows

| Environment | Permitted Times |
|-------------|-----------------|
| Production | Weekdays 09:00-17:00 UTC |
| Staging | 24/7 |

### Rate Limits

- Maximum 100 requests/second to any single endpoint
- Stop immediately if performance degradation observed
- Notify Aragora team before any automated scanning

---

## Test Credentials

### User Accounts (To Be Provided)

| Role | Username | Purpose |
|------|----------|---------|
| Admin | pentest-admin@aragora.ai | Admin function testing |
| Pro User | pentest-pro@aragora.ai | Standard user testing |
| Free User | pentest-free@aragora.ai | Rate limit testing |
| Viewer | pentest-viewer@aragora.ai | RBAC testing |

### API Keys (To Be Provided)

| Key Type | Scope | Purpose |
|----------|-------|---------|
| Full Access | All endpoints | Comprehensive testing |
| Read-Only | GET endpoints | Authorization testing |
| Expired | None | Error handling |

### Workspaces

| Workspace | Purpose |
|-----------|---------|
| pentest-workspace-1 | Primary testing |
| pentest-workspace-2 | Multi-tenancy testing |

---

## Severity Classification

| Severity | CVSS | Examples |
|----------|------|----------|
| **Critical** | 9.0-10.0 | RCE, authentication bypass, mass data exposure |
| **High** | 7.0-8.9 | Privilege escalation, SQL injection, significant data leak |
| **Medium** | 4.0-6.9 | Stored XSS, IDOR with limited impact, information disclosure |
| **Low** | 0.1-3.9 | Reflected XSS, verbose errors, missing headers |
| **Informational** | 0 | Best practice recommendations |

---

## Deliverables

### Final Report Contents

1. **Executive Summary** (1-2 pages)
   - Overall risk rating
   - Key findings summary
   - Remediation priorities

2. **Technical Findings** (Detailed)
   - Vulnerability description
   - Steps to reproduce
   - Evidence (screenshots, requests/responses)
   - CVSS score and justification
   - Remediation recommendations
   - References (CWE, OWASP)

3. **Appendices**
   - Tools used
   - Testing timeline
   - Raw scan data (if applicable)

### Report Format

- PDF with table of contents
- Executive summary suitable for board presentation
- Technical details suitable for engineering team

### Delivery Timeline

| Milestone | Timeline |
|-----------|----------|
| Testing Complete | Day 18 |
| Draft Report | Day 21 |
| Final Report | Day 25 |
| Remediation Verification | Day 45 (optional) |

---

## Remediation SLAs

| Severity | Remediation Target | Verification |
|----------|-------------------|--------------|
| Critical | 48 hours | Immediate retest |
| High | 7 days | Retest included |
| Medium | 30 days | Next assessment |
| Low | 90 days | Next assessment |

---

## Known Security Controls

The following controls are already implemented and should be validated:

### Authentication & Authorization
- [x] JWT-based authentication with short-lived tokens
- [x] OAuth 2.0 / OIDC support
- [x] RBAC with workspace isolation
- [x] API key authentication with scoped permissions
- [x] Rate limiting per IP and token

### Encryption
- [x] AES-256-GCM encryption for secrets at rest
- [x] TLS 1.2+ for all connections
- [x] Encrypted database connections

### Input Validation
- [x] Request body validation on all endpoints
- [x] Parameterized database queries
- [x] Content-Type enforcement

### Logging & Monitoring
- [x] Comprehensive audit logging
- [x] Security event alerting
- [x] Request tracing with correlation IDs

### Infrastructure
- [x] WAF (Web Application Firewall)
- [x] DDoS protection (Cloudflare)
- [x] Container security scanning
- [x] Dependency vulnerability scanning (Dependabot)

---

## Previous Findings (If Applicable)

| Finding | Severity | Status |
|---------|----------|--------|
| (First assessment - N/A) | - | - |

---

## Vendor Requirements

### Qualifications

- CREST, OSCP, or equivalent certification
- Experience with SaaS/multi-tenant applications
- Experience with AI/ML platforms (preferred)
- SOC 2 penetration testing experience

### Insurance

- Professional liability: $1M minimum
- Cyber liability: $2M minimum

### References

- Minimum 3 references from similar engagements
- NDA required before engagement

---

## Contact Information

| Role | Name | Contact |
|------|------|---------|
| Security Lead | [Name] | security@aragora.ai |
| Engineering Lead | [Name] | engineering@aragora.ai |
| Emergency Contact | [Name] | [Phone Number] |

---

## Appendix A: API Documentation

API documentation will be provided separately via:
- OpenAPI/Swagger specification
- Postman collection
- Internal wiki access

---

## Appendix B: Architecture Diagram

```
                                    ┌─────────────────┐
                                    │   Cloudflare    │
                                    │   WAF + DDoS    │
                                    └────────┬────────┘
                                             │
                              ┌──────────────┼──────────────┐
                              │              │              │
                        ┌─────┴─────┐  ┌─────┴─────┐  ┌─────┴─────┐
                        │   API     │  │  Live     │  │  Status   │
                        │  Gateway  │  │ Dashboard │  │   Page    │
                        └─────┬─────┘  └───────────┘  └───────────┘
                              │
              ┌───────────────┼───────────────┐
              │               │               │
        ┌─────┴─────┐   ┌─────┴─────┐   ┌─────┴─────┐
        │   Auth    │   │  Debate   │   │  Admin    │
        │  Service  │   │  Engine   │   │  Service  │
        └─────┬─────┘   └─────┬─────┘   └───────────┘
              │               │
              │         ┌─────┴─────┐
              │         │    AI     │
              │         │ Providers │
              │         └───────────┘
              │
        ┌─────┴─────┐
        │PostgreSQL │──────┐
        │  + Redis  │      │
        └───────────┘      │
                     ┌─────┴─────┐
                     │   S3/     │
                     │  Storage  │
                     └───────────┘
```

---

## Document History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0.0 | 2026-01 | Security Team | Initial release |

---

*This document is confidential and intended only for authorized penetration testing vendors.*
