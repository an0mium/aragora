# Aragora Pre-Pentest Checklist

**Version:** 1.0.0
**Classification:** Confidential
**Date:** February 2026
**SOC 2 Control:** CC7.1 (Security Testing)

---

## Purpose

This checklist ensures the Aragora team and the penetration testing vendor are fully
prepared before active testing begins. Complete all items in order. Each section has a
responsible party and sign-off field.

---

## 1. Environment Setup

### 1.1 Isolated Test Instance

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 1.1.1 | Provision a dedicated test environment | Separate from production and staging. Use `ARAGORA_ENV=test`. Must be network-isolated from production databases. | DevOps | [ ] |
| 1.1.2 | Deploy current release branch | Match the exact version deployed in production. Record the Git SHA. | DevOps | [ ] |
| 1.1.3 | Seed test database | Populate with synthetic data (debates, users, decisions, knowledge entries). No real customer data. | Engineering | [ ] |
| 1.1.4 | Enable all feature flags | Ensure the tester can reach all code paths. Set `ARAGORA_FEATURES_ALL=true` if available. | Engineering | [ ] |
| 1.1.5 | Deploy OpenClaw standalone instance | Provision a separate instance of the standalone gateway (`aragora/compat/openclaw/standalone.py`) on a dedicated port (e.g., 8100). | DevOps | [ ] |
| 1.1.6 | Confirm database backend | Production: PostgreSQL. Test environment should also use PostgreSQL to match production behavior (SQLite differs in locking, migrations). | DevOps | [ ] |
| 1.1.7 | Enable Redis for distributed rate limiting | Deploy Redis instance for the test environment so rate limit middleware (`aragora/server/middleware/rate_limit/redis_limiter.py`) is exercised. | DevOps | [ ] |
| 1.1.8 | Document all service endpoints | Provide the tester with a list of all accessible hosts, ports, and base URLs (API, WebSocket, OpenClaw, health). | DevOps | [ ] |

### 1.2 TLS Configuration

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 1.2.1 | Install valid TLS certificate | Use a real certificate (not self-signed) so TLS testing is meaningful. Let's Encrypt or internal CA. | DevOps | [ ] |
| 1.2.2 | Verify HSTS header | Confirm `Strict-Transport-Security` is present with `max-age` and `includeSubDomains`. Source: `aragora/server/middleware/security_headers.py`. | Engineering | [ ] |
| 1.2.3 | Verify HTTP-to-HTTPS redirect | Confirm all HTTP requests redirect to HTTPS. | DevOps | [ ] |

---

## 2. Test Credentials and Tokens

### 2.1 User Accounts

Create the following accounts in the test environment before the engagement:

| Account | Role | Email | Purpose | Created |
|---------|------|-------|---------|---------|
| pentest-admin | `admin` | pentest-admin@aragora.ai | Admin function testing, privilege escalation validation | [ ] |
| pentest-pro | `pro_user` | pentest-pro@aragora.ai | Standard user testing, IDOR testing | [ ] |
| pentest-free | `free_user` | pentest-free@aragora.ai | Rate limit testing, tier enforcement | [ ] |
| pentest-viewer | `viewer` | pentest-viewer@aragora.ai | Read-only RBAC testing | [ ] |
| pentest-workspace-admin | `workspace_admin` | pentest-wsadmin@aragora.ai | Workspace-level admin testing | [ ] |
| pentest-delegated | `pro_user` | pentest-delegated@aragora.ai | Permission delegation chain testing | [ ] |

**Password policy:** Use strong passwords (20+ chars). Deliver via secure channel (encrypted email or 1Password vault). Never share passwords in plaintext.

### 2.2 API Keys

| Key Name | Scope | Purpose | Created |
|----------|-------|---------|---------|
| pentest-full | All permissions (`*`) | Comprehensive endpoint testing | [ ] |
| pentest-readonly | Read-only (`*.read`) | Authorization boundary testing | [ ] |
| pentest-debates | `debates.*` | Scoped permission testing | [ ] |
| pentest-expired | None (expired) | Error handling and expired token testing | [ ] |
| pentest-revoked | Revoked after creation | Token revocation testing | [ ] |
| pentest-empty-scope | Empty permissions set | Verify `APIKeyScope` with empty permissions behavior (grants full access per current design) | [ ] |

### 2.3 Workspaces and Tenants

| Workspace | Tenant | Members | Purpose |
|-----------|--------|---------|---------|
| pentest-workspace-1 | pentest-tenant-1 | pentest-admin, pentest-pro | Primary testing workspace |
| pentest-workspace-2 | pentest-tenant-2 | pentest-viewer | Cross-tenant isolation testing |
| pentest-workspace-3 | pentest-tenant-1 | pentest-workspace-admin | Cross-workspace isolation testing |

### 2.4 OpenClaw Gateway Credentials

| Item | Value | Notes |
|------|-------|-------|
| API key | Set `ARAGORA_OPENCLAW_API_KEY` env var | For testing F01 authentication |
| Test session | Pre-create an active session | For session hijacking tests |
| Test credentials (agent creds) | Store test credentials in the gateway | For credential encryption testing (F02) |

### 2.5 OIDC/SSO Test Configuration

| Item | Details | Done |
|------|---------|------|
| Configure a test OIDC provider (e.g., Keycloak) | Provide discovery URL, client ID, client secret | [ ] |
| Create test OIDC users | Map to pentest accounts | [ ] |
| Document callback URLs | List all valid redirect URIs configured | [ ] |

---

## 3. Rate Limit Configuration for Testing

### 3.1 Adjustments

During the penetration test, rate limits should be adjusted to allow meaningful testing
without triggering false-positive blocks, while still allowing rate limit bypass testing.

| Configuration | Normal Value | Test Value | Reason |
|---------------|-------------|------------|--------|
| Per-IP request limit | Varies by endpoint | 10x normal | Allow automated scanning without constant blocking |
| Per-user request limit | Varies by tier | 10x normal | Allow repeated endpoint testing |
| Login attempt lockout | 5 attempts / 15 min | 50 attempts / 15 min | Allow brute force testing of auth flows |
| OAuth rate limit | Standard | 10x normal | Allow OAuth flow testing |
| OpenClaw per-endpoint limit | 30--120 req/min | 10x normal | Allow gateway testing |

### 3.2 Rate Limit Bypass Testing

| # | Task | Details | Done |
|---|------|---------|------|
| 3.2.1 | Provide one IP range with NO rate limiting | Allow the tester to verify rate limit bypass techniques from a separate IP | [ ] |
| 3.2.2 | Document rate limit headers | Confirm `X-RateLimit-Limit`, `X-RateLimit-Remaining`, `Retry-After` headers are present | [ ] |
| 3.2.3 | Provide Redis access for distributed rate limit inspection | Read-only Redis access so tester can verify distributed counters | [ ] |

### 3.3 Restoration Plan

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 3.3.1 | Document original rate limit values | Record all values before modification | Engineering | [ ] |
| 3.3.2 | Create restoration script | Script to reset all rate limits to production values | Engineering | [ ] |
| 3.3.3 | Schedule restoration | Restore within 24 hours of test completion | DevOps | [ ] |

---

## 4. Logging and Monitoring During Test

### 4.1 Enhanced Logging

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 4.1.1 | Enable DEBUG-level logging for auth modules | `aragora.auth`, `aragora.rbac`, `aragora.server.middleware.auth` | Engineering | [ ] |
| 4.1.2 | Enable DEBUG-level logging for security modules | `aragora.security`, `aragora.security.ssrf_protection`, `aragora.security.anomaly_detection` | Engineering | [ ] |
| 4.1.3 | Enable audit logging at maximum verbosity | Ensure `aragora/server/middleware/audit_logger.py` captures all events | Engineering | [ ] |
| 4.1.4 | Enable RBAC audit logging | `aragora/rbac/audit.py` should log all authorization decisions (allow and deny) | Engineering | [ ] |
| 4.1.5 | Enable tenant isolation security logger | `aragora.security.tenant_isolation` logger captures all cross-tenant access attempts | Engineering | [ ] |
| 4.1.6 | Enable OpenTelemetry tracing | Full request tracing via `aragora/observability/tracing.py` for post-test analysis | Engineering | [ ] |
| 4.1.7 | Configure log retention | Retain all logs for at least 90 days post-engagement for finding verification | DevOps | [ ] |

### 4.2 Monitoring Dashboards

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 4.2.1 | Set up Prometheus metrics collection | Scrape test environment metrics (rate limit counters, auth failures, circuit breaker trips) | DevOps | [ ] |
| 4.2.2 | Create Grafana dashboard for pentest | Panels: HTTP 4xx/5xx rates, auth failures, rate limit rejections, response latencies | DevOps | [ ] |
| 4.2.3 | Configure anomaly detection alerts | Set `aragora/security/anomaly_detection.py` thresholds for brute force and impossible travel to alert (not block) during testing | Engineering | [ ] |
| 4.2.4 | Provide tester with read-only monitoring access | Grafana viewer role for the pentest team | DevOps | [ ] |

### 4.3 Log Access for Tester

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 4.3.1 | Provide log query access | Read-only access to test environment logs (e.g., CloudWatch, ELK, Loki) | DevOps | [ ] |
| 4.3.2 | Document log locations | Provide paths/queries for: application logs, audit logs, security event logs, RBAC decision logs | Engineering | [ ] |

---

## 5. Documentation for Tester

### 5.1 Required Documentation

Provide the following to the pentest vendor before engagement start:

| # | Document | Location | Delivered |
|---|----------|----------|-----------|
| 5.1.1 | Pentest scope document | `docs/security/PENTEST_SCOPE.md` | [ ] |
| 5.1.2 | Threat model | `docs/security/THREAT_MODEL.md` | [ ] |
| 5.1.3 | OpenClaw audit findings | `docs/security/OPENCLAW_AUDIT.md` | [ ] |
| 5.1.4 | OpenAPI specification | Export from `/api/openapi.json` on test instance | [ ] |
| 5.1.5 | Postman collection | Export from `/api/postman.json` or generate from OpenAPI | [ ] |
| 5.1.6 | Architecture diagram | Included in `PENTEST_SCOPE.md` and `THREAT_MODEL.md` | [ ] |
| 5.1.7 | RBAC role/permission matrix | Export all roles, permissions, and default assignments from `aragora/rbac/types.py` and `aragora/rbac/models.py` | [ ] |
| 5.1.8 | API versioning guide | Document v1 vs v2 endpoint availability and deprecation status | [ ] |
| 5.1.9 | WebSocket event catalog | List of all 190+ event types with required permissions | [ ] |
| 5.1.10 | Environment variable reference | `docs/reference/ENVIRONMENT.md` (redacted: no real values, only variable names and descriptions) | [ ] |

### 5.2 Access Provisioning

| # | Task | Details | Owner | Done |
|---|------|---------|-------|------|
| 5.2.1 | Tester VPN access | VPN credentials for accessing the test environment if it is not publicly exposed | DevOps | [ ] |
| 5.2.2 | Source code access (optional) | Read-only Git access if gray-box scope includes code review | Engineering | [ ] |
| 5.2.3 | Slack/Teams channel | Create a dedicated channel for real-time communication during the engagement | Security Lead | [ ] |

---

## 6. Incident Response Contacts

### 6.1 Escalation Matrix

| Severity | Contact | Method | Response Time |
|----------|---------|--------|---------------|
| Critical finding (RCE, auth bypass, mass data exposure) | Security Lead + CTO | Phone + Slack | 1 hour |
| High finding (privilege escalation, significant data leak) | Security Lead | Slack + Email | 4 hours |
| Medium finding (XSS, IDOR, info disclosure) | Security Lead | Email | 24 hours |
| Low / Informational | Security Lead | Email | End of engagement |
| Test environment outage | DevOps On-Call | Slack | 30 minutes |
| Accidental production impact | Security Lead + CTO + DevOps | Phone | Immediate |

### 6.2 Contact Details

| Role | Name | Email | Phone | Slack |
|------|------|-------|-------|-------|
| Security Lead | [Name] | security@aragora.ai | [Phone] | @security-lead |
| CTO | [Name] | [Email] | [Phone] | @cto |
| DevOps On-Call | Rotation | devops@aragora.ai | [Phone] | @devops-oncall |
| Engineering Lead | [Name] | engineering@aragora.ai | [Phone] | @eng-lead |

### 6.3 Emergency Procedures

| Scenario | Procedure |
|----------|-----------|
| Tester accidentally accesses production | Stop testing immediately. Notify Security Lead via phone. Document the access in writing within 1 hour. |
| Test environment becomes unresponsive | Notify DevOps On-Call via Slack. DevOps will restart services or provision a new instance. |
| Real vulnerability actively exploited during test | Notify Security Lead via phone. Engineering patches within the SLA (48h for Critical). Tester stops testing that vector. |
| Tester discovers real customer data in test environment | Stop testing immediately. Notify Security Lead. Quarantine the data. Investigate how it got there. |

---

## 7. Data Cleanup Procedure Post-Test

### 7.1 Tester-Side Cleanup

| # | Task | Deadline | Confirmed |
|---|------|----------|-----------|
| 7.1.1 | Delete all local copies of test data | Within 7 days of report delivery | [ ] |
| 7.1.2 | Delete all captured requests/responses | Within 7 days of report delivery | [ ] |
| 7.1.3 | Delete all credentials and API keys | Immediately after engagement ends | [ ] |
| 7.1.4 | Securely wipe scanning tool output | Within 7 days of report delivery | [ ] |
| 7.1.5 | Confirm deletion in writing | Email to security@aragora.ai | [ ] |

### 7.2 Aragora-Side Cleanup

| # | Task | Owner | Deadline | Done |
|---|------|-------|----------|------|
| 7.2.1 | Revoke all pentest API keys | Engineering | Day of engagement end | [ ] |
| 7.2.2 | Disable all pentest user accounts | Engineering | Day of engagement end | [ ] |
| 7.2.3 | Rotate any credentials that were shared | Engineering | Day of engagement end | [ ] |
| 7.2.4 | Destroy test environment | DevOps | Within 7 days of report delivery | [ ] |
| 7.2.5 | Archive test environment logs | DevOps | Before environment destruction | [ ] |
| 7.2.6 | Restore rate limits to production values | Engineering | Day of engagement end | [ ] |
| 7.2.7 | Review and archive audit logs | Security Lead | Within 7 days | [ ] |
| 7.2.8 | Revoke tester VPN access | DevOps | Day of engagement end | [ ] |
| 7.2.9 | Revoke tester monitoring access | DevOps | Day of engagement end | [ ] |
| 7.2.10 | Remove tester from Slack/Teams channel | Security Lead | Within 7 days | [ ] |

### 7.3 Data Retention

| Data Type | Retention Period | Storage | Owner |
|-----------|-----------------|---------|-------|
| Pentest report (final) | Indefinite (SOC 2 requirement) | Secure document store | Security Lead |
| Test environment logs | 90 days post-engagement | Log archive | DevOps |
| Raw scan data (tester) | Deleted within 7 days | Tester systems | Tester |
| Communication records (Slack/email) | 1 year | Standard retention | Security Lead |

---

## 8. Pre-Engagement Sign-Off

All parties must sign off before active testing begins.

### 8.1 Internal Sign-Off

| Role | Name | Date | Signature |
|------|------|------|-----------|
| Security Lead | [Name] | [Date] | [ ] |
| CTO / CISO | [Name] | [Date] | [ ] |
| Engineering Lead | [Name] | [Date] | [ ] |
| DevOps Lead | [Name] | [Date] | [ ] |
| Legal | [Name] | [Date] | [ ] |

### 8.2 Vendor Sign-Off

| Item | Confirmed |
|------|-----------|
| NDA signed | [ ] |
| Statement of Work signed | [ ] |
| Rules of engagement reviewed and accepted | [ ] |
| Test credentials received and verified | [ ] |
| Emergency contact list received | [ ] |
| Scope document reviewed and agreed | [ ] |
| Insurance verification provided | [ ] |

### 8.3 Final Readiness Check

| # | Checkpoint | Status |
|---|-----------|--------|
| 8.3.1 | Test environment is accessible and functional | [ ] |
| 8.3.2 | All test accounts can authenticate | [ ] |
| 8.3.3 | API keys return expected responses | [ ] |
| 8.3.4 | WebSocket connections establish successfully | [ ] |
| 8.3.5 | OpenClaw standalone is reachable | [ ] |
| 8.3.6 | Logging is capturing events | [ ] |
| 8.3.7 | Monitoring dashboards are populated | [ ] |
| 8.3.8 | Rate limits are adjusted per section 3 | [ ] |
| 8.3.9 | All documentation delivered per section 5 | [ ] |
| 8.3.10 | Communication channels are established | [ ] |

---

*This checklist is confidential and intended for internal use and authorized pentest vendors only.*
