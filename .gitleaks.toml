# Gitleaks configuration for Aragora
# https://github.com/gitleaks/gitleaks

title = "Aragora Secret Scanning"

[extend]
# Use default rules
useDefault = true

# Allow test keys and example placeholders
[[rules]]
id = "allow-test-keys"
description = "Allow test keys in test files"
regex = '''sk-ant-test-.*'''
allowlist = true

[[rules]]
id = "allow-example-placeholders"
description = "Allow example/placeholder values"
regex = '''your-.*-key|your-api-key|<your-.*>|YOUR_.*'''
allowlist = true

# Paths to exclude from scanning
[allowlist]
description = "Global allowlist"
paths = [
    '''.*_test\.py$''',
    '''.*test_.*\.py$''',
    '''.*\.test\.ts$''',
    '''.*\.spec\.ts$''',
    '''.*\.example$''',
    '''.*\.template$''',
    '''\.env\.example$''',
    '''\.env\.local\.example$''',
    '''\.env\.template$''',
    '''docs/.*\.md$''',
]

# Specific commit allowlist (if needed for legacy commits)
# commits = ["abc123..."]
