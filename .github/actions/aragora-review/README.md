# Aragora Design Review Action

Review designs and specifications in your CI/CD pipeline using multi-agent debate with compliance personas.

## Features

- **Multi-agent debate** - Multiple AI agents review and critique designs
- **Compliance personas** - SOX, PCI-DSS, HIPAA, GDPR, FISMA, and more
- **Decision receipts** - Audit-ready documentation of the review process
- **PR comments** - Automatic posting of review results to pull requests
- **Configurable gates** - Fail builds based on consensus or dissent

## Usage

### Basic Usage

```yaml
name: Design Review

on:
  pull_request:
    paths:
      - 'docs/**.md'
      - 'design/**.md'

jobs:
  review:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Review Design
        uses: an0mium/aragora/.github/actions/aragora-review@main
        with:
          api-key: ${{ secrets.ARAGORA_API_KEY }}
          file: docs/design.md
          personas: security,performance,architecture
```

### Compliance Review

```yaml
- name: SOX Compliance Review
  uses: an0mium/aragora/.github/actions/aragora-review@main
  with:
    api-key: ${{ secrets.ARAGORA_API_KEY }}
    file: docs/financial-system.md
    personas: sox,security,audit
    fail-on-dissent: true
```

### Healthcare Review

```yaml
- name: HIPAA Compliance Review
  uses: an0mium/aragora/.github/actions/aragora-review@main
  with:
    api-key: ${{ secrets.ARAGORA_API_KEY }}
    file: docs/patient-data-flow.md
    personas: hipaa,fda_21_cfr,security
    fail-on-no-consensus: true
```

### Payment System Review

```yaml
- name: PCI-DSS Review
  uses: an0mium/aragora/.github/actions/aragora-review@main
  with:
    api-key: ${{ secrets.ARAGORA_API_KEY }}
    file: docs/payment-processing.md
    personas: pci_dss,security,sox
    rounds: 5
```

## Inputs

| Input | Description | Required | Default |
|-------|-------------|----------|---------|
| `api-key` | Aragora API key | Yes* | - |
| `file` | Path to file to review | No** | - |
| `spec` | Inline specification text | No** | - |
| `personas` | Comma-separated personas | No | `security,performance` |
| `rounds` | Number of debate rounds | No | `3` |
| `fail-on-dissent` | Fail if dissenting opinions | No | `false` |
| `fail-on-no-consensus` | Fail if no consensus | No | `false` |
| `comment-on-pr` | Post results as PR comment | No | `true` |
| `base-url` | Custom API URL | No | `https://api.aragora.ai` |

*Can also use `ARAGORA_API_KEY` secret
**Either `file` or `spec` is required

## Outputs

| Output | Description |
|--------|-------------|
| `consensus-status` | Status: `reached`, `partial`, `not_reached` |
| `consensus-position` | Final agreed position |
| `dissent-count` | Number of dissenting opinions |
| `review-id` | Unique review ID for audit |
| `result-json` | Full result as JSON |

## Available Personas

### Compliance

| Persona | Description |
|---------|-------------|
| `sox` | Sarbanes-Oxley financial controls |
| `pci_dss` | Payment Card Industry security |
| `hipaa` | Healthcare data protection |
| `gdpr` | European data privacy |
| `fda_21_cfr` | FDA electronic records |
| `fisma` | Federal security (NIST 800-53) |
| `finra` | Financial industry regulations |

### Technical

| Persona | Description |
|---------|-------------|
| `security` | General security review |
| `performance` | Performance and scalability |
| `architecture` | System design |
| `testing` | Test coverage |

## Example PR Comment

The action posts a formatted comment to PRs:

```
## üîç Aragora Design Review

**Review ID:** `rev_abc123`
**Personas:** sox, security, pci_dss

### ‚úÖ Consensus: reached

**Position:**
> The design meets SOX requirements for audit trails and segregation of duties...

### ‚ö†Ô∏è Dissenting Opinions (1)

<details>
<summary><b>pci_dss</b></summary>

The tokenization approach should clarify PAN handling in logs...

**Concerns:**
- Log redaction strategy not specified
- Key rotation procedure missing

</details>

---
*Generated by Aragora multi-agent review*
```

## Secrets

Store your API key as a repository secret:

1. Go to Settings ‚Üí Secrets and variables ‚Üí Actions
2. Click "New repository secret"
3. Name: `ARAGORA_API_KEY`
4. Value: Your Aragora API key

## License

MIT License
